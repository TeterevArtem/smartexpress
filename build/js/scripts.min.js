$('.fiveth__acco_title').on('click', function(e){
    e.preventDefault();
    var $this = $(this),
        item = $this.closest('.fiveth__acco_item'),
        curentContent = item.find('.fiveth__acco_content'),
        container = $this.closest('.fiveth__acco__list'),
        content = container.find('.fiveth__acco_content');
 
    if(!item.hasClass('active')) {
      content.slideUp();
      item.addClass('active').siblings().removeClass('active');
      curentContent.stop(true, true).slideDown();
    }else{  
      curentContent.slideUp();
      item.removeClass('active');
    };
  });
let swiper = null;
const menu = ["Главная","О нас", "Как это работает","Отслеживание трека/Новости","Faq"];

function swiperInit() {
  if(!swiper){
    swiper = new Swiper('.swiper-container', {
      // Optional parameters
      direction: 'horizontal',
      loop: false,
      slidesPerView: 1,
      mousewheel: true,
      allowTouchMove: false,

      // If we need pagination
      pagination: {
        el: '.nav__list.pages',
        clickable: true,
        renderBullet: function (index, className) {
            return '<span class="' + className + '">' + (menu[index]) + '</span>';
          },
        },  
      // And if we need scrollbar
      scrollbar: { 
        el:'.swiper-scrollbar',
        dragSize: 20,
      },
    });

    const bullets = document.querySelectorAll('.swiper-pagination-bullet'),
          progressbar = document.querySelector('.progressbar.swiper-scrollbar'),
          active = 'swiper-pagination-bullet-active';

    swiper.on('slideChange', function() {
      if (swiper.pagination.bullets[1].classList.contains(active) || swiper.pagination.bullets[2].classList.contains(active)) {
        progressbar.classList.add('light');
        bullets.forEach(item =>{
          item.classList.add('light')
        })
      }else{
        progressbar.classList.remove('light')
        bullets.forEach(item =>{
          item.classList.remove('light')
        })
      }
    });
  };
};

function checkSize () {
  let windowWidth = $(window).width();
  if (windowWidth > 768) {
    swiperInit();
  }else{
    if (swiper) {
      swiper.destroy(true, false);
      swiper = null;
    }
  }
}

$(document).ready(function(){
  checkSize();
});

$(window).on('resize', function() {
  checkSize();
});


var swiperNews = new Swiper('.swiper-news', {
  slidesPerView: 4,
  navigation: {
    nextEl: '.swiper-button-next',
    prevEl: '.swiper-button-prev',
  },
  breakpoints: {
    768: {
      slidesPerView: 1,
    }
  }
})
swiperNews.init();





(function () {
  var kyrgizstan = {latitude : 41.44032465815312, longitude: 74.54018682859221};
  $(".map__container").mapael({
    map : {
      name : "world_countries",
      defaultArea: {
        attrs : {
          fill : '#aaaaaa',
          'fill-opacity' : .5,
          stroke : '#dbdfe3',
          'stroke-opacity' : 0.3
        },
        attrsHover : {
          fill: "#aaaaaa"
        }
      },
      defaultPlot: {
        text: {
            attrs: {
                fill: "#000"
            },
            attrsHover: {
                fill: "#000"
            }
        },
      },
      defaultLink: {
        factor: -0.3,
        attrs: {
          "stroke-width" : 2
        }
      }      
    },
    areas : {
      'KG' : {
        attrs : {
          fill: '#ff0000'
        },
        attrsHover:{
          fill: '#ff0000',
          stroke: '#000000'
        },
        tooltip: {
          content: 'Доставка осуществляется в офис Smart-Express или на адресс указанный при регистрации'
        }
      },
      'US' : {
        attrsHover : {
          fill: "#1487C0"
        },
        tooltip: {
          content: 'USA - Доставка со склада'
        }
      },
      'RU' : {
        attrsHover : {
          fill: "#1487C0"
        },
        tooltip: {
          content: 'Россия - Доставка со склада'
        }
      },
      'CN' : {
        attrsHover : {
          fill: "#1487C0"
        },
        tooltip: {
          content: 'Китай - Доставка со склада'
        }
      },
      'TR' : {
        attrsHover : {
          fill: "#1487C0"
        },
        tooltip: {
          content: "Турция - Доставка со склада"
        }
      },
    },
    links : {
      'usa' : {
        between: [{latitude : 39.93655552135767, longitude : -100.34947498261911}, kyrgizstan]
      },
      'turkey' : {
        between: [{latitude : 39.0186131215694, longitude: 35.390945095197786}, kyrgizstan]        
      },
      'russia' : {
        between: [{latitude: 62.29284454019792, longitude: 93.08714460538374}, kyrgizstan]
      },
      'china' : {
        between: [{latitude: 34.49225492147402, longitude: 104.18868789984857}, kyrgizstan]
      }

    }

  });
})()

const closeBtn = document.querySelectorAll('.popup__close'),
      authBtn = document.querySelectorAll('.auth__link_login'),
      calcBtn = document.querySelectorAll('.first__bottom_link'),
      continueBtn = document.querySelectorAll('.popup__button_continue');

function showPopup(buttons, parent) {
  buttons.forEach(item => {
    item.addEventListener('click', (e) => {
      e.preventDefault();
      
      $('.popup').fadeOut();
      $(item).closest(parent).find('.popup').fadeIn();
    });
  });
};

showPopup(authBtn, '.header__item_login');
showPopup(calcBtn, '.first__bottom_item_right');

closeBtn.forEach(btn => {
  btn.addEventListener('click', (e) => {
    e.preventDefault();

    $(e.target).closest('.popup').fadeOut();
  });
});

function showCalculator(elem, parent) {
  $(elem).closest('.popup__info').fadeOut(function(){
    $(parent).find('.popup__calc').fadeIn();
  });
}

continueBtn.forEach(button => {
  button.addEventListener('click', (e) => {
    e.preventDefault();

    var parent = $(e.target).closest('.popup');
    showCalculator(e.target, parent);

  });
});

const signBlock = document.querySelector('.signin__block'),
      signForm = signBlock.querySelector('.sign__form'),
      nextBtn = document.querySelector('.signin__popup_button'),
      steps = signForm.querySelectorAll('.signin__form_step');      

$('.auth__link_signin').on('click', function(e) {
  e.preventDefault();
  signForm.reset();
  $(signBlock).fadeIn();
});



// nextBtn.addEventListener('click', function(e){
//   e.preventDefault();
 
  
// })







